<!DOCTYPE html>
<html>

<head>
    <title>API Trigger Links with Message Input</title>
</head>

<body>
    <h1>API Trigger Links</h1>

    <button onclick="sendApiRequest('Todd trying to figure things out', 'Todd Emerson')">Todd's Alert</button><br><br>
    <button onclick="sendApiRequest('System error reported', 'System')">System Alert</button><br><br>
    <button onclick="sendApiRequest('John requesting assistance', 'John Doe')">John's Request</button><br><br>
    <button onclick="sendApiRequest('Alert from safety team', 'Safety Team')">Safety Alert</button><br><br>

    <button onclick="sendApiRequest(null, null, true)">Custom Alert</button> <br><br>

    <script>
        function sendApiRequest(msg, username, usePrompt = false) {
            let message = msg;
            let user = username;

            if (usePrompt) {
                message = prompt('Enter custom message:');
                user = prompt('Enter custom username:');
                if (!message || !user) {
                    alert('Message and username are required.');
                    return; // Stop execution if input is canceled or empty
                }
            } else if (!message || !user) {
                alert("message and username are required");
                return;
            }

            const timestamp = new Date().toISOString();

            const data = {
                trigger: true,
                msg: message,
                username: user,
                timestamp: timestamp
            };

            fetch('https://67dc7a98e00db03c40683241.mockapi.io/alarms/1', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
                .then(response => response.json())
                .then(responseData => {
                    console.log('API Response:', responseData);
                    alert('API request sent successfully!');
                })
                .catch(error => {
                    console.error('API Error:', error);
                    alert('API request failed. Check console.');
                });
        }
    </script>
</body>

</html>